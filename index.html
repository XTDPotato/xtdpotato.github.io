<!doctype html>
<html lang="zh-CN" class="mdui-theme-auto">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no"
    />
    <meta name="renderer" content="webkit" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <link rel="stylesheet" href="https://unpkg.com/mdui@2.0.3/mdui.css" />
    <script src="https://unpkg.com/mdui@2.0.3/mdui.global.js"></script>

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet" />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons+Two+Tone"
      rel="stylesheet"
    />

    <title>XTDPotato的中转站</title>

    <style>
      :root {
        --mobile-topbar-height: 56px;
        --mobile-nav-height: 72px;
        --mobile-fab-size: 56px;
        --mobile-fab-inset: 32px;
        --desktop-tabs-left-inset: 0px;
      }

      html,
      body {
        height: 100%;
        margin: 0;
      }

      body {
        overflow: hidden;
      }

      .app-shell {
        height: 100vh;
        display: flex;
        width: 100%;
        max-width: 1280px;
        margin: 0 auto;
        box-sizing: border-box;
        padding: 8px;
        gap: 8px;
      }

      .main-drawer {
        margin: 0;
        z-index: 1000;
      }

      .main-drawer::part(panel) {
        max-height: 100vh;
      }

      .main-drawer::part(body) {
        max-height: 100vh;
        overflow: auto;
      }

      .desktop-nav {
        display: block;
        position: relative;
        z-index: 10;
      }

      .mobile-nav {
        display: none;
      }

      .mobile-topbar {
        display: none;
      }

      .mobile-topbar-actions {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        margin-right: 4px;
      }

      .mobile-fab {
        display: none;
        width: var(--mobile-fab-size);
        height: var(--mobile-fab-size);
      }

      .main-tabs {
        flex: 1;
        height: 100%;
        padding-left: var(--desktop-tabs-left-inset);
        box-sizing: border-box;
      }

      .tab-panel {
        margin: 0;
        height: calc(100vh - 16px);
        padding: 0;
        opacity: 1;
        transform: translateX(0);
        transition: opacity 160ms ease, transform 160ms ease;
      }

      .tab-panel.tab-fade-out {
        opacity: 0;
        transform: translateX(-10px);
      }

      .tab-panel.tab-fade-in {
        opacity: 0;
        transform: translateX(10px);
      }

      .content-frame {
        border: 0;
        width: 100%;
        height: 100%;
        display: block;
        margin: 0;
      }

      .fab-animated {
        transition: transform 160ms ease, opacity 160ms ease;
      }

      .fab-animated.fab-swap-out {
        transform: translateY(8px) scale(0.92);
        opacity: 0;
      }

      .fab-animated.fab-swap-in {
        transform: translateY(0) scale(1);
        opacity: 1;
      }

      .bottom-nav-group {
        flex: 1 1 auto;
        display: flex !important;
        justify-content: space-evenly;
        align-items: center;
        gap: 4px;
        min-width: 0;
        flex-wrap: nowrap;
      }

      .bottom-nav-btn {
        appearance: none;
        border: 0;
        background: transparent;
        color: inherit;
        padding: 8px 6px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2px;
        min-width: 64px;
        box-sizing: border-box;
      }

      .bottom-nav-label {
        font-size: 12px;
        line-height: 1;
        opacity: 0.85;
      }

      .bottom-nav-btn.active {
        color: rgb(var(--mdui-color-primary, 25 118 210));
        background: color-mix(in srgb, rgb(var(--mdui-color-primary, 25 118 210)) 16%, transparent);
        border-radius: 10px;
      }

      @media (max-width: 900px), (pointer: coarse) {
        .app-shell {
          position: fixed;
          left: 0;
          right: 0;
          top: var(--mobile-topbar-height);
          bottom: calc(var(--mobile-nav-height) + env(safe-area-inset-bottom));
          padding: 0;
          gap: 0;
          max-width: none;
          margin: 0;
          width: 100vw;
          height: auto;
        }

        .desktop-nav {
          display: none;
        }

        .mobile-topbar {
          display: flex;
          position: fixed;
          left: 0;
          right: 0;
          top: 0;
          z-index: 30;
          background: var(--mdui-color-surface, #fff);
        }

        .mobile-nav {
          display: block;
          position: fixed;
          left: 0;
          right: 0;
          bottom: 0;
          z-index: 20;
          height: calc(var(--mobile-nav-height) + env(safe-area-inset-bottom));
          padding-bottom: env(safe-area-inset-bottom);
          box-sizing: border-box;
        }

        #mobile_navbar {
          position: relative;
          width: 100%;
          height: 100%;
        }

        .main-tabs {
          padding-left: 0;
          box-sizing: border-box;
          height: 100%;
        }

        .tab-panel {
          height: 100%;
        }

        .mobile-fab {
          display: block;
          position: fixed;
          right: var(--mobile-fab-inset);
          bottom: calc(var(--mobile-nav-height) + env(safe-area-inset-bottom) + var(--mobile-fab-inset));
          z-index: 25;
        }
      }
    </style>
  </head>

  <body>
    <mdui-navigation-drawer
      id="main_drawer"
      close-on-overlay-click
      class="main-drawer"
    >
      <mdui-list>
        <mdui-list-subheader>抽屉</mdui-list-subheader>

        <mdui-collapse>
          <mdui-collapse-item id="themeCollapseMain">
            <mdui-list-item
              slot="header"
              icon="dark_mode"
              headline="主题模式 (当前: 自动)"
            ></mdui-list-item>
            <mdui-list id="themeCollapseContentMain">
              <mdui-list-item
                class="theme-option"
                data-theme="auto"
                icon="brightness_auto"
                headline="自动 (跟随系统)"
              ></mdui-list-item>
              <mdui-list-item
                class="theme-option"
                data-theme="light"
                icon="light_mode"
                headline="日间模式"
              ></mdui-list-item>
              <mdui-list-item
                class="theme-option"
                data-theme="dark"
                icon="dark_mode"
                headline="夜间模式"
              ></mdui-list-item>
            </mdui-list>
          </mdui-collapse-item>
        </mdui-collapse>


        <mdui-list-item active rounded class="drawer_btn1" id="drawer_btn1">
          <mdui-icon slot="icon" name="home--outlined"></mdui-icon>主页
        </mdui-list-item>

        <mdui-list-item rounded class="drawer_btn2" id="drawer_btn2">
          <mdui-icon slot="icon" name="bubble_chart--outline"></mdui-icon>帖子
        </mdui-list-item>

        <mdui-list-item rounded class="drawer_btn3" id="drawer_btn3">
          <mdui-icon slot="icon" name="account_circle--outline"></mdui-icon>我的
        </mdui-list-item>
      </mdui-list>
    </mdui-navigation-drawer>

    <mdui-top-app-bar class="mobile-topbar">
      <mdui-button-icon id="mobile_menu_btn" icon="menu"></mdui-button-icon>
      <mdui-top-app-bar-title id="mobile_title">XTDPotato</mdui-top-app-bar-title>
      <div style="flex-grow: 1"></div>
      <div class="mobile-topbar-actions" id="mobile_topbar_actions">
        <mdui-button-icon id="mobile_action_1" style="display: none"></mdui-button-icon>
        <mdui-button-icon id="mobile_action_2" style="display: none"></mdui-button-icon>
        <mdui-dropdown placement="bottom-end">
          <mdui-button-icon id="mobile_more_btn" slot="trigger" icon="more_vert" style="display: none"></mdui-button-icon>
          <mdui-menu id="mobile_more_menu"></mdui-menu>
        </mdui-dropdown>
      </div>
    </mdui-top-app-bar>

    <div class="app-shell">
      <mdui-navigation-rail value="saying" divider contained class="desktop-nav">
        <mdui-button-icon id="fab_menu" icon="menu" slot="top"></mdui-button-icon>
        <mdui-fab lowered id="main_fab" class="fab-animated" icon="add--outlined" slot="top"></mdui-fab>

        <mdui-navigation-rail-item
          id="rail_item_saying"
          value="saying"
          icon="message--outlined"
          >话说</mdui-navigation-rail-item
        >
        <mdui-navigation-rail-item
          id="rail_item_resources"
          value="resources"
          icon="archive--outlined"
          >导航</mdui-navigation-rail-item
        >
        <mdui-navigation-rail-item id="rail_item_notes" value="notes" icon="notes--outlined"
          >笔记</mdui-navigation-rail-item
        >
        <mdui-navigation-rail-item
          id="rail_item_courses"
          value="courses"
          icon="tips_and_updates--outlined"
          >教程</mdui-navigation-rail-item
        >
      </mdui-navigation-rail>

      <mdui-tabs id="main_tabs" value="saying" class="main-tabs">
        <mdui-tab style="display: none" value="saying">话说</mdui-tab>
        <mdui-tab style="display: none" value="resources">资源</mdui-tab>
        <mdui-tab style="display: none" value="notes">笔记</mdui-tab>
        <mdui-tab style="display: none" value="courses">教程</mdui-tab>

        <mdui-tab-panel class="tab-panel" slot="panel" value="saying">
          <iframe id="saying_frame" src="saying.html" class="content-frame"></iframe>
        </mdui-tab-panel>

        <mdui-tab-panel class="tab-panel" slot="panel" value="resources">
          <iframe
            id="resources_item_frame"
            src="resources_item.html"
            class="content-frame"
          ></iframe>
        </mdui-tab-panel>

        <mdui-tab-panel class="tab-panel" slot="panel" value="notes">
          <iframe id="notes_item_frame" src="notes_item.html" class="content-frame"></iframe>
        </mdui-tab-panel>

        <mdui-tab-panel class="tab-panel" slot="panel" value="courses">
          <iframe id="courses_frame" src="courses.html" class="content-frame"></iframe>
        </mdui-tab-panel>
      </mdui-tabs>
    </div>

    <div class="mobile-nav">
      <mdui-navigation-bar id="mobile_navbar" value="saying">
        <mdui-navigation-bar-item icon="message--outlined" value="saying">话说</mdui-navigation-bar-item>
        <mdui-navigation-bar-item icon="archive--outlined" value="resources">导航</mdui-navigation-bar-item>
        <mdui-navigation-bar-item icon="notes--outlined" value="notes">笔记</mdui-navigation-bar-item>
        <mdui-navigation-bar-item icon="tips_and_updates--outlined" value="courses"
          >教程</mdui-navigation-bar-item
        >
      </mdui-navigation-bar>
    </div>

    <mdui-fab id="main_fab_mobile" class="mobile-fab fab-animated" icon="add--outlined"></mdui-fab>

    <mdui-snackbar class="snackbar_no_action" closeable>提示</mdui-snackbar>

    <script type="text/javascript" src="js/index.js"></script>
    <script>
      const PRIMARY_KEY = "xtd_theme_primary";

      function applyColorScheme(color) {
        if (!color || !/^#[0-9a-fA-F]{6}$/.test(color)) return;
        if (window.mdui?.setColorScheme) window.mdui.setColorScheme(color);
      }

      function broadcastPrimary(color) {
        const frames = [
          document.getElementById("saying_frame"),
          document.getElementById("resources_item_frame"),
          document.getElementById("notes_item_frame"),
          document.getElementById("courses_frame"),
        ];
        for (const frame of frames) {
          frame?.contentWindow?.postMessage({ type: "theme:primary", color }, "*");
        }
      }

      const saved = localStorage.getItem(PRIMARY_KEY);
      if (saved) applyColorScheme(saved);

      window.addEventListener("message", (event) => {
        const data = event?.data;
        if (!data || data.type !== "theme:primary") return;
        const color = data.color;
        if (!color || !/^#[0-9a-fA-F]{6}$/.test(color)) return;
        localStorage.setItem(PRIMARY_KEY, color);
        applyColorScheme(color);
        broadcastPrimary(color);
      });

      window.addEventListener("storage", (event) => {
        if (event.key !== PRIMARY_KEY) return;
        const color = event.newValue;
        if (!color || !/^#[0-9a-fA-F]{6}$/.test(color)) return;
        applyColorScheme(color);
        broadcastPrimary(color);
      });
    </script>
  </body>
</html>
